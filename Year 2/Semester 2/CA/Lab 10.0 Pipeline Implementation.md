---
tags: [Notebooks/CA]
title: Lab 10.0 Pipeline Implementation
created: '2022-05-06T07:58:19.743Z'
modified: '2022-05-06T08:29:05.850Z'
---

# Lab 10.0 Pipeline Implementation

- Solves the issue of the long clock cycle time of the sincle cycle mips

## Things to consider
- choose between moving the mux for regWrite from the ID to EX stage

### Hazards
1. Structural Hazards (resources wanted by multiple instructions)
2. Data Hazards (want data before it's ready to be used, )
3. Control Hazards (generated by pipelining of branches/jumps)

### Solutions
a. Hardware (optimal)
- forwarding
- stalling

b. Software
- introduce NoOps

### Concrete issues:
***1. Structural***
- want to read a value that wasn't written before.
- solutions:
  - modify RF such that writing is done on the falling edge
  - NoOp

Pipeline Diagram
|Instr/Clk|CC1|CC2|CC3|CC4|CC5|CC6|CC7|CC8|...|
|-|-|-|-|-|-|-|-|-|-|
|add $1, $1, $2|IF|ID|EX|MEM|***WB***
|instr1||IF|ID|EX|MEM|WB|
|instr1|||IF|ID|EX|MEM|WB|
|add $3, $1, $4||||IF|***ID***|EX|MEM|WB

***2. Data Hazards***
- Use pipeline diagram

|Instr. Nb.|Program|
|-|-|
1|add $1, $2, $3
2|NoOp
3|NoOp
4|add $3, $1, $2
5|NoOp
6|add $4, $1, $2
7|add $5, $3, $2
8|NoOp
9|NoOp
10|lw $3, 5($5)
11|NoOp
12|NoOp
13|add $4, $5, $3
14|NoOp
15|sw $3, 6($5)
16|beq $3, $4, -6

***3. Control Hazards***
- occur in case of J and BEQ because instructions after them start to execute even though we want to change the flow of the program.
- Branch: next 3 instructions are executed (insert 3 NoOps - *inefficient*)
- J: next first instruction starts its execution (insert 1 NoOp - *inefficient*)
- *Better solution* - insert the instruction that would be afterJ, before it (if it s not a jump/branch)

## TODO:

1. Implement the Pipeline MIPS in VHDL
- registers
2. Modify the test program to solve hazards
- careful about JUMP
- draw pipeline diagram
- modify assembly code

3. Test on FPGA
- check if it is the same result

4. (Optional) Hardware implementation of the optimizations


